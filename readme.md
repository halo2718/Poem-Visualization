# 中国古代诗词数据可视化

## 数据预处理
### 主题提取
对应`preprocess_poem.py`和`lda.py`。
1. 将json数据提取为csv
2. 使用[DeepTHULAC](https://github.com/thunlp/DeepTHULAC)对古诗词数据进行分词
3. 使用[tomotopy](https://bab2min.github.io/tomotopy/v0.12.2/en/)基于分词后的数据学习LDA主题模型，主题数目设为100
	* 由于不同朝代诗词数量差距较大（例如明代诗词有26余万首，而大部分朝代的诗词数量都在几千、几万首量级），为了避免某个年代对主题有过大的影响，我们对于存在超过6万首诗词的朝代随机抽取其中的6万首诗词
4. 使用学到的LDA主题模型对每首诗词进行分析，获得其对应的top-3主题及对应概率
### 意象抽取
使用tf-idf进行抽取，并人工判断了是否为意象，最终保留前60个。

### 气泡图、河流图数据预处理
对于每个朝代，将该朝代所有诗词的top-3主题概率相加，平均后得到100个主题在该朝代的平均概率分布，取前20个用于绘制气泡图，存储于`data/bubble.json`。河流图同理。
### 意象排序变化图
对于关键词统计在各个朝代对应诗词中的词频，存储于`data/keywords_change_by_dynasty.json`。
情感分析：对于每个朝代，遍历该朝代所有诗歌，并检查是否包含我们考虑的60个意象，若包含则利用BERT情感预测器，利用全诗的文本预测情感积极程度，并在该意象的记录表中增添该情感积极程度。
### 主题-意象弦图
使用LDA模型计算每个主题的词分布，提取出60个意象对应的词分布，并进行正则化，存储于data/`topic_keywords_chords.json`。
### 意象关联弦图
计算意象的本身频度及共现次数，分别存储于`data/keywords_freq.json`和`data/keywords_co_occurance.json`。